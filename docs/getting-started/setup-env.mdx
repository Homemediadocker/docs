---
id: setup-env
title: Setup your Env
description: Commands to setup your environment
sidebar_position: 2
---

# Env Setup

:::tip Note
Additional modification can be done in the [docker-compose.yml](https://github.com/Homemediadocker/Home-Media-Docker/blob/main/docker-compose.yml), but most things are variablized for you in the .env file. Please read through these steps to configure for your host machine.
:::

- Do this to create your `.env` file:

```sh
cp .env-example .env
```

You will need to adjust the newly created `.env` file with values specific to your machine. These values are marked with a comment `#CHANGE_ME`

Literally everything in the docker compose file is variablized as much as possible.

<details>
    <summary><strong>.env file explained</strong></summary>

```bash
## CONTAINER  DATA LOCATION
# This will place the container data in the current repo location.
# You can change this and all data will be placed in that location.
DEFAULT_CONTAINER_DATA_LOCATION="./.containers" # Change this if you want the data outside of this repo
TRAEFIK_CONFIG_DIRECTORY="../traefik-data"
PROJECT_HOSTNAME="localhost"

####### TRAEFIK/ACME ############
CF_API_EMAIL="" # Cloudflare email address used
CF_DNS_API_TOKEN="" # Cloudflare api token (global)
ACME_DNS_CHALLENGE_PROVIDER="cloudflare" # The provider name -- cloudflare and netlify are supported out of the box
TRAEFIK_TLS_CERTRESOLVER="cloudflare" # The provider name -- cloudflare and netlify are supported out of the box
TRAEFIK_DASHBOARD_CREDENTIALS=admin:$$2y$$05$$cqTXRio8juH740Wo7m4y5OWFbQKB0eTaHexKPYmssn4qctTe8ElQe # just admin/password but hashed.
TRAEFIK_NETLIFY_TOKEN="asdfasdfasdfasdfasdfasdfasdfasdf" # API Token from netlify dashboard

## COMPOSE_PROFILES ---- Use this variable to select which containers you would like to spin up.
## Or you can just pass "all" into the variable and it will spin up everything (except the media server, that requires you to pass it in yourself)
# COMPOSE_PROFILES=all

## or all with media server
# COMPOSE_PROFILES=all,jellyfin

## Or just individually comma separate your services.
COMPOSE_PROFILES=bookstack,dashy,duplicati,jellyseerr,komga,pihole,portainer,prowlarr,radarr,sonarr,transmission,vpn,jellyfin,homeassistant,zwavejs,zigbee2mqtt

## OPTIONS ---- bookstack,dashy,duplicati,jellyseerr,komga,pihole,portainer,prowlarr,radarr,sonarr,transmission,vpn
## MORE OPTIONS- jellyfin,emby,plex,homeassistant,zwavejs,zigbee2mqtt,homeAutomation,all

############################################
########## CONTAINER NAMES #################
############################################
BOOKSTACK_APP_CONTAINER_NAME="bookstack"
BOOKSTACK_DB_CONTAINER_NAME="bookstack_db"
DASHY_CONTAINER_NAME="dashy"
DUPLICATI_CONTAINER_NAME="duplicati"
EMBY_CONTAINER_NAME="emby"
HEIMDALL_CONTAINER_NAME="heimdall"
HOME_ASSISTANT_CONTAINER_NAME="homeassistant"
JACKETT_CONTAINER_NAME="jackett"
JELLYFIN_CONTAINER_NAME="jellyfin"
JELLYSEERR_CONTAINER_NAME="jellyseerr"
KOMGA_CONTAINER_NAME="komga"
PIHOLE_CONTAINER_NAME="pihole"
PLEX_CONTAINER_NAME="plex"
PORTAINER_CONTAINER_NAME="portainer"
PROWLARR_CONTAINER_NAME="prowlarr"
RADARR_CONTAINER_NAME="radarr"
SONARR_CONTAINER_NAME="sonarr"
TRAEFIK_CONTAINER_NAME="traefik"
TRANSMISSION_CONTAINER_NAME="transmission"
VPN_CONTAINER_NAME="vpn"
ZIGBEE2MQTT_CONTAINER_NAME="zigbee2mqtt"
ZWAVE_JS_CONTAINER_NAME="zwavejs"

## NORDVPN SPECIFIC VARIABLES
TOKEN=11111111111223123123123123asdba123 # This is specific to nord VPN - found in the account settings and generated by the user
PRIVATE_KEY=sdlfkabakjhslkdgjadlfkjasdfhaskdjhagsdg ##CHANGE ME - follow instructions to obtain the private key
NORD_TECHNOLOGY=NordLynx # NordLynx or OpenVPN
NORD_CONNECT_AREA=United_States # You can separate this by country and city too, but if you leave it blank it will just default to the recommended fastest server

VPN_DNS="8.8.8.8,8.8.4.4" #CHANGE_ME - this is google's DNS if that works for you
VPN_ALLOWED_IPS="0.0.0.0/0" #CHANGE_ME - this allows all IPs
VPN_NET_LOCAL="172.16.0.0/12,192.168.0.0/16" #CHANGE_ME if your network doesn't fit this schema

## User Host Machine - unix machines can find this by doing `id <username>`
UID="111" ##CHANGE ME this is usually the user id on the host machine that will be running the docker compose command. But you can make this be a less privileged user and that is fine too
GID="111" ##CHANGE ME group id of the associated user(s) that may be running this. This is passed into the docker env so keep in mind that this will be the only one in there.
TIMEZONE="America/Chicago" ##CHANGE ME - Your timezone. This gets passed into basically every container.

## Samba
SMB_USER="samba" ##CHANGE ME If you are on Mac, this SMB user is what will be used to mount the network drives on your machine.
SMB_PASS="test" ##CHANGE ME If you are on Mac, this SMB password is what will be used to mount the network drives on your machine.

## unix machines can find this by doing `id <username>` for the desired user's id on that machine
SMB_UID="12312" ##CHANGE ME The user ID that has access to the smb shares
SMB_GID="123123" ##CHANGE ME the group ID that has access to the smb shares

## Network Paths
MOVIE_NETWORK_SHARE="//IP.IP.IP.IP/SHARENAME" ##CHANGE ME network share for movies content
TV_NETWORK_SHARE="//IP.IP.IP.IP/SHARENAME" ##CHANGE ME network share for tv content

## Local Paths
LOCAL_MOVIES_PATH="/Volumes/Movies" # #CHANGE ME - this is if you don't use the network shares in the dockerfile, and want to mount them on the host machine.
LOCAL_TV_PATH="/Volumes/Television" # #CHANGE ME - this is if you don't use the network shares in the dockerfile, and want to mount them on the host machine.
LOCAL_BOOKS_PATH="/Volumes/Books" #CHANGE_ME - this is if you don't use the network shares in the dockerfile, and want to mount them on the host machine.
LOCAL_DOWNLOADS_PATH="/Volumes/Downloads" # #CHANGE ME - this is if you don't use the network shares in the dockerfile, and want to mount them on the host machine. This is for transmission specifically.

## Jellyseerr
JELLYSEER_LOG_LEVEL="info" # change this to `debug` to show more logs.
JELLYSEER_TYPE="emby" # #CHANGE ME -  emby, jellyfin, plex --- those are all options

## PLEX
PLEX_CLAIM=""
PLEX_VERSION="docker"

## Komga
KOMGA_LIBRARIES_SCAN_STARTUP="true"
KOMGA_JAVA_OPTS="-Xmx8g" ## 8 GB - this helps reduce times waiting for pages to process and reduces crashing
KOMGA_REMEMBERME_KEY="" #CHANGE ME - need to add this to be able to remember a login

## JACKETT - THIS IS PROBABLY NOT USED BUT HERE THEY ARE
JACKETT_RUN_OPTS=""
JACKETT_AUTO_UPDATE="true"

## TRANSMISSION
TRANSMISSION_USER="transmission" ### #CHANGE ME
TRANSMISSION_PASS="noissimsnart" ### #CHANGE ME
TRANSMISSION_PEERPORT=""
TRANSMISSION_HOST_WHITELIST=""

## DUPLICATI
DUPLICATI_CLI_ARGS=""

## ZWAVE2MQTT (ZWAVEJS)
ZWAVE_STICK_DEVICE_PATH="/path/to/usb" #CHANGE_ME
# ZWAVE_STICK_DEVICE_PATH="/dev/cu.usbserial-533D0042421"

## Zigbee2MQTT (Zigbee)
ZIGBEE_STICK_DEVICE_PATH="/path/to/usb" #CHANGE_ME
#ZIGBEE_STICK_DEVICE_PATH="/dev/serial/by-id/usb-Texas_Instruments_TI_CC2531_USB_CDC___0X00124B0018ED3DDF-if00"

## PIHOLE
PIHOLE_SECURE_WEB_PASSWORD="pihole"
PIHOLE_STATIC_IP_ADDRESS="192.168.1.200"
PIHOLE_NETWORK_GATEWAY="192.168.1.1"
PIHOLE_NETWORK_ADDRESS_POOL="192.168.1.0/24"
PIHOLE_NETWORK_INTERFACE="eth0"

## Dashy
# Your Backup ID: xxxx-xxxx-xxxx-xxxx
DASHY_CONFIG_LOCATION="./dashy-config.yml"

## Bookstack - OSS Confluence Alternative
BOOKSTACK_PORT="6875"
BOOKSTACK_APP_URL="https://${PROJECT_HOSTNAME}" #CHANGE_ME - if you are hosting outside your local machine


BOOKSTACK_DB_HOST="${BOOKSTACK_DB_CONTAINER_NAME}"
BOOKSTACK_DB_PORT=3306
BOOKSTACK_DB_NAME="bookstackapp" #CHANGE_ME - optionally change. this can stay
BOOKSTACK_DB_USER="bookstack" #CHANGE_ME
BOOKSTACK_DB_PASS="kcatskoob" #CHANGE_ME
BOOKSTACK_DB_ROOT_PASS="kcatskoob" #CHANGE_ME

#######################################################################################################################
##################################### DANGER BELOW - THESE ARE DEFAULT VALUES FOR PORTS ###############################
#######################################################################################################################

## EXPOSED PORTS ---
## These are defaults and can be changed,
## but use caution and take backups because changing these
## may lead to loss of access to a service
BOOKSTACK_WEB_HOST_HTTP_PORT="${BOOKSTACK_PORT}"
DASHY_HOST_HTTP_PORT="4000"
DUPLICATI_HOST_PORT="8200"
EMBY_HOST_PORT="8096"
EMBY_HOST_PORT_SSL="8920"
EMBYSTAT_HOST_PORT="6555"
HEIMDALL_HOST_HTTP_PORT="3080"
HEIMDALL_HOST_HTTPS_PORT="30803"
JACKETT_HOST_PORT="9117"
JELLYFIN_HOST_PORT="8096"
JELLYFIN_HOST_PORT_SSL="8920"
JELLYSEERR_HOST_PORT="5055"
KOMGA_HOST_PORT="8341"
PIHOLE_HOST_PORT="8880"
PLEX_HOST_PORT="32400"
PORTAINER_HOST_PORT="9000"
PORTAINER_HOST_PORT_SSL="49443"
PROWLARR_HOST_PORT="9696"
RADARR_HOST_PORT="7878"
SONARR_HOST_PORT="8989"
SONARR_HOST_PORT_SSL="9898"
TRAEFIK_DASHBOARD_PORT="8080"
TRANSMISSION_HOST_PORT="9091"
TRANSMISSION_SEED_DISCOVERY_PORT_TCP="51413"
TRANSMISSION_SEED_DISCOVERY_PORT_UDP="51413"


#### HOME AUTOMATION EXPOSED PORTS ####
HOME_ASSISTANT_HOST_PORT="8123"
ZIGBEE2MQTT_HOST_PORT="38080"
ZWAVE_JS_UI_HOST_PORT="8091"
ZWAVE_JS_WS_HOST_PORT="3000"

## Gitlab specific
RUNNER_NAME=RUNNER-NAME
REGISTRATION_TOKEN=TOKEN
CI_SERVER_URL=https://gitlab.com/

##### AUTHENTIK ######
#### I KNOW SOME OF THESE ARE DUPED. I'll clean these up in a later commit
# .env (in ALL)
DOCKERDIR=${DEFAULT_CONTAINER_DATA_LOCATION}  # CHANGEME
PUID=${UID}               # CHANGEME
PGID=${GID}               # CHANGEME
TZ=${TIMEZONE}
DOMAIN=${PROJECT_HOSTNAME}    # CHANGEME


################################################################
# PostgreSQL
################################################################
POSTGRES_DB=pgauthentik
POSTGRES_USER=authentik
POSTGRES_PASSWORD=testing123
PG_PASS=testing123


################################################################
# Authentik
################################################################
AUTHENTIK_REDIS__HOST=authentik_redis
AUTHENTIK_LISTEN__HTTP=authentik-server:8000
AUTHENTIK_LISTEN__HTTPS=authentik-server:8443

AUTHENTIK_POSTGRESQL__HOST=authentik_postgresql
AUTHENTIK_POSTGRESQL__NAME=$POSTGRES_DB
AUTHENTIK_POSTGRESQL__USER=$POSTGRES_USER
AUTHENTIK_POSTGRESQL__PASSWORD=$POSTGRES_PASSWORD

AUTHENTIK_ERROR_REPORTING__ENABLED: "false"
AUTHENTIK_SECRET_KEY=123123123123123123123123123123
# WORKERS=2

# SMTP Host Emails are sent to
AUTHENTIK_EMAIL__HOST=smtp.gmail.com
AUTHENTIK_EMAIL__PORT=587
# Optionally authenticate (don't add quotation marks to your password)
AUTHENTIK_EMAIL__USERNAME=CHANGEME@gmail.com
AUTHENTIK_EMAIL__PASSWORD=/run/secrets/authelia_notifier_smtp_password
# Use StartTLS
AUTHENTIK_EMAIL__USE_TLS=false
# Use SSL
AUTHENTIK_EMAIL__USE_SSL=false
AUTHENTIK_EMAIL__TIMEOUT=10
# Email address authentik will send from, should have a correct @domain
AUTHENTIK_EMAIL__FROM=CHANGEME@gmail.com

#########################################################################################
########## ENABLE MIDDLEWARES IF YOU WANT TO USE PROXY AUTHENTICATION ###################
#########################################################################################
# PROWLARR_AUTHENTIK_MIDDLEWARE="traefik.http.routers.${PROWLARR_CONTAINER_NAME}.middlewares=middlewares-authentik@file"
# RADARR_AUTHENTIK_MIDDLEWARE="traefik.http.routers.${RADARR_CONTAINER_NAME}.middlewares=middlewares-authentik@file"
# SONARR_AUTHENTIK_MIDDLEWARE="traefik.http.routers.${SONARR_CONTAINER_NAME}.middlewares=middlewares-authentik@file"
# TRAEFIK_DASHBOARD_AUTHENTIK_MIDDLEWARE="traefik.http.routers.${TRAEFIK_CONTAINER_NAME}.middlewares=middlewares-authentik@file"


################################################################
# GeoIP
################################################################
GEOIPUPDATE_ACCOUNT_ID=CHANGEME
GEOIPUPDATE_LICENSE_KEY=CHANGEME
AUTHENTIK_AUTHENTIK__GEOIP=/geoip/GeoLite2-City.mmdb
GEOIPUPDATE_EDITION_IDS=GeoLite2-City
GEOIPUPDATE_FREQUENCY=8
```

</details>

## Default Container Location

The default location where all container data is persisted is in `./.containers/*` this is in the project directory. You can change this easily to point at your own home directory if you would like it more easily accessible.

## Compose Profiles

This is an interesting feature in docker that allows this project to essentially work with feature flags.

```bash
COMPOSE_PROFILES=...
```

Doing this allows you to enable whatever services you would like to run in the setup down to the most granular level. This variable is set when the [helper-scripts](./helper-scripts.mdx) are run as well. This allows you to make minimal changes to the yaml files themselves and only make `.env` changes.

**See [Docker Info](./docker-info.mdx) for more information regarding including other services.**

## Nord VPN Variables

### Private Key / TOKEN

:::info Important!
Token and subscription to NordVPN Is needed to use this.
[See here](https://support.nordvpn.com/hc/en-us/articles/20286980309265-How-to-use-a-token-with-NordVPN-on-Linux) for configuring/retrieving your `TOKEN` in Linux.
:::
This is required to run Nord VPN. Without it, the vpn will not start up or be linked to an account.

### IP Configuration

```shell
VPN_DNS="8.8.8.8,8.8.4.4" #CHANGE_ME - this is google's DNS if that works for you
VPN_ALLOWED_IPS="0.0.0.0/0" #CHANGE_ME - this allows all IPs
VPN_NET_LOCAL="172.16.0.0/12,192.168.0.0/16" #CHANGE_ME if your network doesn't fit this schema
```

- The `VPN_ALLOWED_IPS` is just a filler - this allows all IPs to connect to your instance. Configure this with a proper subnet here with allowed hosts to connect.
- The `VPN_NET_LOCAL` - These are local IP Addresses. This should work for most home networks. This is a comma-separated list of IP addresses with allowed CIDR ranges.

## UID/GID

This is specific to your host machine's user ID and group ID. If you run on a Unix based system then you can find these values for a user by doing the following:

```bash
id <username>
```

## Local Shares (Recommended)

Mount the drives you want on your host machine and have them setup to connect on boot. Then reference those paths in your variables. Comment out what you don't need.

:::tip Pro Tip
Doing it this way vs the network route ensures that the network paths are connected via your host machine. Docker networking can be a pain, so local is recommended. However, if you want to use Samba shares, you can, just be prepared to change the docker-compose file a lot.

Using local also has way less headaches if you are unfamiliar with docker's volume setup.

Emby and Jellyfin can also do realtime monitoring, but they do not work with Network shares! If you mount the network share on your host machine and then make it local to the container, it doesn't know the difference! You can have realtime monitoring without having to deal with network shares in the docker container!
:::

These are examples using network shares mounted locally on my own Macbook setup:

```bash
## Local Paths
LOCAL_MOVIES_PATH="/Volumes/Movies" #CHANGE_ME
LOCAL_TV_PATH="/Volumes/Television" #CHANGE_ME
LOCAL_BOOKS_PATH="/Volumes/Books" #CHANGE_ME
LOCAL_DOWNLOADS_PATH="/Volumes/Downloads" #CHANGE_ME
```

## Samba

### SMB (Samba) Shares User and Pass

This is specifically for mounting network shares. If you do not need this (i.e. if the host machine mounts the drives before docker spins up) then you can comment them out.

### SMB UID and GID

This may or may not be the same as the UID and GID above. For that reason I have separated it into different variables (if you needed to have only readonly access for a user or something).

### Network Shares

These are the IP Addresses and share names related to the network shares that you would like to mount as SMB shares.

## Jellyseer

Change this to be either `jellyfin`, `emby`, or `plex`

```shell
JELLYSEER_TYPE="jellyfin" #CHANGE_ME - based on what you decide for media server
```

## Transmission

The username and password is here in the env file. Please do change this and document it.

```shell
## TRANSMISSION
TRANSMISSION_USER="transmission" #CHANGE_ME
TRANSMISSION_PASS="noissimsnart" #CHANGE_ME
```

## Dashy

This is where the default configuration that ships with this project is based. This location can be changed if you would like to create a new config file, or would like to import someone else's.

```shell
DASHY_CONFIG_LOCATION="./dashy-config.yml"
```

## Pihole

The PiHole web password is defined here. Please change this from the default.

```shell
PIHOLE_SECURE_WEB_PASSWORD="pihole"
```

## ZWave JS and Zigbee2MQTT

If you decide to use ZWaveJS and Home Assistant, you will need to setup the USB dongle for the zwave network to function:

```shell
ZWAVE_STICK_DEVICE_PATH="/path/to/usb" #CHANGE_ME
ZIGBEE_STICK_DEVICE_PATH="/path/to/usb" #CHANGE_ME
```
